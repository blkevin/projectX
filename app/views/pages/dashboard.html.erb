<div class="container">
  <h3>Hello <%= @user.first_name %> ! Bienvenue sur ton tableau de bord üó∫Ô∏è</h3>



<%# Conversations %>
  <div class="d-flex">
    <div class="col-8 conversations">
      <div class="preview-messages">
        <h4>üëã Continue la conversation !</h4>
            <% if @user.status == "student" %>
              <% @conversations.each do |conversation| %>
                <div class="chat-card">
                  <%= cl_image_tag User.find(conversation.mentor_id).photo.key, crop: :fill, class: "card-avatar" %>
                  <ul>
                    <li> <strong><%= User.find(conversation.mentor_id).first_name %> <%= User.find(conversation.mentor_id).last_name %></strong></li>
                    <li> <%= conversation.messages.last.content[0, 40]... %></li>
                  </ul>
                </div>
              <% end %>
            <% else %>
              <% @conversations.each do |conversation| %>
              <div class="chat-card">
                <%= cl_image_tag User.find(conversation.student_id).photo.key, crop: :fill, class: "card-avatar" %>
                <ul>
                  <li><strong><%= User.find(conversation.student_id).first_name %> <%= User.find(conversation.student_id).last_name %></strong></li>
                  <li> <%= conversation.messages.last.content[0, 40]... %></li>
                </ul>
              </div>
              <% end %>
            <% end %>
        </div>

  </div>

<%# Meetings %>

  <%# Upcoming Meetings %>
    <div class="col-4 meetings">
      <div class="upcoming-meetings">
        <h4>üóìÔ∏è Tes futurs rendez-vous</h4>
          <% if @user.status == "student" %>
            <% @upcoming_meetings.each do |meeting| %>
              <div class="meeting-card">
                <div class="d-flex">
                  <%= cl_image_tag User.find(meeting.mentor_id).photo.key, crop: :fill, class: "card-avatar" %>
                  <div class="card-infos">
                    <ul>
                      <li> <h5><%= User.find(meeting.mentor_id).first_name %> <%= User.find(meeting.mentor_id).last_name %></h5></li>
                      <li> <strong><%= User.find(meeting.mentor_id).experiences.last.position %></strong> chez <%= User.find(meeting.mentor_id).experiences.last.company %></li>
                      <li> Le <strong><%= meeting.starting.strftime("%c") %></strong> </li>
                    </ul>
                  </div>
                </div>
              </div>
            <% end %>

          <% else %>
              <% @upcoming_meetings.each do |meeting| %>
              <div class="meeting-card">
              <%= cl_image_tag User.find(meeting.student_id).photo.key, height: 300, width: 400, crop: :fill, class: "card-avatar" %>
                <li> <h5><%= User.find(meeting.student_id).first_name %> <%= User.find(meeting.student_id).last_name %></h5></li>
                <li> <%= User.find(meeting.student_id).experiences.last.position %> chez <%= User.find(meeting.student_id).experiences.last.company %></li>
                <li> Le <strong><%= meeting.starting.strftime("%c") %></strong> </li>
              </div>
              <% end %>
            <% end %>
          </ul>
      </div>
  <%# Past Meetings %>
    <div class="past-meetings">
      <h4>üóìÔ∏è Tes pr√©d√©dents rendez-vous</h4>
        <% if @user.status == "student" %>
          <% @past_meetings.each do |meeting| %>
          <div class="meeting-card">
            <%= cl_image_tag User.find(meeting.mentor_id).photo.key, height: 100, width: 100, crop: :fill, class: "card-avatar" %>
              <div class="card-infos">
                <ul>
                  <li> <h5><%= User.find(meeting.mentor_id).first_name %> <%= User.find(meeting.mentor_id).last_name %></h5></li>
                  <li> <strong><%= User.find(meeting.mentor_id).experiences.last.position %></strong> chez <%= User.find(meeting.mentor_id).experiences.last.company %></li>
                  <li> Le <strong><%= meeting.starting.strftime("%c") %></strong> </li>
                <ul>
              </div>
          </div>
            <% end %>
          <% else %>
            <% @past_meetings.each do |meeting| %>
            <div>
              <%= cl_image_tag User.find(meeting.student_id).photo.key, height: 300, width: 400, crop: :fill, class: "card-avatar" %>
              <li> Pr√©nom = <%= User.find(meeting.student_id).first_name %> </li>
              <li> Nom = <%= User.find(meeting.student_id).last_name %> </li>
              <li> Age = <%= User.find(meeting.student_id).age %> </li>
              <li> Le = <%= meeting.starting %> </li>
            </div>
            <% end %>
          <% end %>
        </ul>
      </div>
    </div>
  </div>
</div>
